apiVersion: apps/v1
kind: Deployment
metadata:
    name: storage-microservice
    namespace: able-dev
    labels:
        app: storage-microservice
spec:
    replicas: 1
    selector:
        matchLabels:
            app: storage-microservice
    template:
        metadata:
            labels:
                app: storage-microservice
        spec:
            imagePullSecrets:
                - name: gcr-json-key
            containers:
                -   name: storage-microservice
                    image: gcr.io/able-dev/storage:TAG
                    imagePullPolicy: Always
                    envFrom:
                        -   configMapRef:
                                name: app-service-config
                        -   secretRef:
                                name: app-service-secrets
                    resources:
                        limits:
                            cpu: "500m"
                            memory: "512Mi"
                        requests:
                            cpu: "200m"
                            memory: "256Mi"
                    terminationMessagePath: /dev/termination-log
                    terminationMessagePolicy: File
            restartPolicy: Always
            terminationGracePeriodSeconds: 30
            dnsPolicy: ClusterFirst
            securityContext: { }
            schedulerName: default-scheduler
    strategy:
        type: RollingUpdate
        rollingUpdate:
            maxUnavailable: 25%
            maxSurge: 25%
    revisionHistoryLimit: 10
    progressDeadlineSeconds: 600
